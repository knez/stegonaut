var Base32={encode:function(e){var t=[];var r,n,i,a,o;var s,c,u,f,d,h,l,p;var v=0;while(v<e.length){r=e[v++];n=e[v++];i=e[v++];a=e[v++];o=e[v++];s=r>>3;c=(r&7)<<2|n>>6;u=n>>1&31;f=(n&1)<<4|i>>4;d=(i&15)<<1|a>>7;h=a>>2&31;l=(a&3)<<3|o>>5;p=o&31;if(!isNaN(o)){t.push(s,c,u,f,d,h,l,p)}else{if(isNaN(n)){t.push(s,c)}else if(isNaN(i)){t.push(s,c,u,f)}else if(isNaN(a)){t.push(s,c,u,f,d)}else if(isNaN(o)){t.push(s,c,u,f,d,h,l)}}}return t},decode:function(e){var t=[];var r,n,i,a,o;var s,c,u,f,d,h,l,p;var v=0;while(v<e.length){s=e[v++];c=e[v++];u=e[v++];f=e[v++];d=e[v++];h=e[v++];l=e[v++];p=e[v++];r=s<<3|c>>2;n=(c&3)<<6|u<<1|f>>4;i=(f&15)<<4|d>>1;a=(d&1)<<7|h<<2|l>>3;o=(l&7)<<5|p;if(!isNaN(p)){t.push(r,n,i,a,o)}else{if(isNaN(u)){t.push(r)}else if(isNaN(d)){t.push(r,n)}else if(isNaN(h)){t.push(r,n,i)}else{t.push(r,n,i,a)}}}return t}};function clearText(){message.value="";message.focus();charCounter(message)}function copyText(){message2.select();document.execCommand("copy");alert("Copied to clipboard!")}function checkPassword(e){if(e&&e.length<8){alert("Password must be at least 8 characters long");return false}return true}function enableHoverEffects(){var e=document.getElementById("dropArea");e.ondragover=function(){e.style.borderColor="#f90"};e.ondragleave=function(){e.style.borderColor="#ddd"};e.ondrop=function(){e.style.borderColor="#ddd"}}function charCounter(e){var t=encodeUTF8(e.value);if(t.length>maxChars){var r=maxChars,n=0;while(t[r--]>>6==2)n++;e.value=decodeUTF8(t.slice(0,maxChars-n))}else{counter.value="Remaining characters: "+(maxChars-t.length)}}function toggleDiv(e){var t=document.getElementById(e);if(t.style.display==="none"){t.style.display="block"}else{t.style.display="none"}}function reset(e){toggleDiv(e);toggleDiv("main");input.value="";message.value="";message2.value="";encPwd.value="";decPwd.value=""}function triggerDownload(e,t){var r=window.URL.createObjectURL(t);var n=document.createElement("a");document.body.appendChild(n);n.style="display: none";n.href=r;n.download=e;n.click();window.URL.revokeObjectURL(r)}function wordArrayToByteArray(e,t){t=e.sigBytes;e=e.words;var r=[],n,i=0;while(t>0){n=wordToByteArray(e[i++],Math.min(4,t));t-=n.length;r.push(n)}return[].concat.apply([],r)}function wordToByteArray(e,t){var r=[];if(t>0)r.push(e>>>24);if(t>1)r.push(e>>>16&255);if(t>2)r.push(e>>>8&255);if(t>3)r.push(e&255);return r}function encodeUTF8(e){var t=[],r=0;for(var n=0;n<e.length;n++){var i=e.charCodeAt(n);if(i<128){t[r++]=i}else if(i<2048){t[r++]=i>>6|192;t[r++]=i&63|128}else if((i&64512)==55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)==56320){i=65536+((i&1023)<<10)+(e.charCodeAt(++n)&1023);t[r++]=i>>18|240;t[r++]=i>>12&63|128;t[r++]=i>>6&63|128;t[r++]=i&63|128}else{t[r++]=i>>12|224;t[r++]=i>>6&63|128;t[r++]=i&63|128}}return t}function decodeUTF8(e){var t=[],r=0,n=0;var i,a,o,s;while(r<e.length){i=e[r++];if(i<128){t[n++]=String.fromCharCode(i)}else if(i>191&&i<224){a=e[r++];t[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){a=e[r++];o=e[r++];s=e[r++];var c=((i&7)<<18|(a&63)<<12|(o&63)<<6|s&63)-65536;t[n++]=String.fromCharCode(55296+(c>>10));t[n++]=String.fromCharCode(56320+(c&1023))}else{a=e[r++];o=e[r++];t[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return t.join("")}var mp3,maxChars;var input=document.getElementById("input");var encPwd=document.getElementById("encPwd");var decPwd=document.getElementById("decPwd");var counter=document.getElementById("counter");var message=document.getElementById("message");var message2=document.getElementById("message2");function loadFile(){var e=new FileReader;var t=input.files[0];if(!t.name.endsWith(".mp3")){alert("Not an MP3 ¯\\_(ツ)_/¯")}else{e.onload=function(){mp3=new MP3Stego(t.name,e.result);initScreen()};e.readAsArrayBuffer(t)}}function initScreen(){toggleDiv("main");if(mp3.isModified()){toggleDiv("extractBox")}else{maxChars=mp3.spaceLeft();counter.value="Remaining characters: "+maxChars;toggleDiv("embedBox")}}function embedText(){if(!checkPassword(encPwd.value))return;var e=message.value;if(encPwd.value){mp3.embedText(encryptText(e))}else{mp3.embedText(encodeUTF8(e))}mp3.download()}function extractText(){if(!checkPassword(decPwd.value))return;var e=mp3.extractText();if(decPwd.value){e=decryptText(e)}message2.value=decodeUTF8(e)}function encryptText(e){var t=CryptoJS.AES.encrypt(e,encPwd.value,{mode:CryptoJS.mode.CTR,padding:CryptoJS.pad.NoPadding});e=atob(t.toString()).substr(8);var r=e.split("").map(function(e){return e.charCodeAt(0)});return r}function decryptText(e){var t=String.fromCharCode.apply(String,e);t=btoa("Salted__"+t);var r=CryptoJS.AES.decrypt(t,decPwd.value,{mode:CryptoJS.mode.CTR,padding:CryptoJS.pad.NoPadding});return wordArrayToByteArray(r)}function MP3Parser(e){var n=new Uint8Array(e);var i=0;var a=0;var o=n.byteLength;var t=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,0];var r=[44.1,48,32,0];var s,c,u;var f=function(e){return e[3]|e[2]<<7|e[1]<<14|e[0]<<21};var d=function(){var e=n.slice(o-128,o-125);var t=String.fromCharCode.apply(String,e);if(t=="TAG"){o=o-128}e=n.slice(0,3);t=String.fromCharCode.apply(String,e);if(t=="ID3"){var r=n.slice(6,10);a=i=f(r)+10}};var h=function(){var e=n[a+2];s=t[e>>4];c=r[(e&12)>>2];u=(e&2)>>1};d();this.getFrameHeader=function(){return n.slice(a+2,a+4)};this.setFrameHeader=function(e){n[a+2]=e[0];n[a+3]=e[1]};this.nextFrame=function(){h();var e=Math.trunc(144*s/c+u);a+=e};this.hasNext=function(){return a<o};this.seekStart=function(){a=i};this.getRaw=function(){return n}}function MP3Stego(e,t){var r=e;var n=new MP3Parser(t);var i=function(e){n.seekStart();o(31);n.nextFrame();for(var t=0;t<4;t++){o(e>>t*5&31);n.nextFrame()}};var a=function(){n.seekStart();n.nextFrame();var e=0;for(var t=0;t<4;t++){e=e|s()<<t*5;n.nextFrame()}return e};var o=function(e){var t=n.getFrameHeader();t[0]=t[0]&254|e>>4;t[1]=t[1]&240|e&15;n.setFrameHeader(t)};var s=function(){var e=n.getFrameHeader();return(e[0]&1)<<4|e[1]&15};var c=function(){var e=0;while(n.hasNext()){e++;n.nextFrame()}return e};this.isModified=function(){n.seekStart();return s()==31};this.spaceLeft=function(){var e=c();e=e-5-13;return Math.trunc((e*5+1)/8)};this.embedText=function(e){var t=Base32.encode(e);i(t.length);for(var r=0;r<t.length;r++){o(t[r]);n.nextFrame()}};this.extractText=function(){var e=[];var t=a();for(var r=0;r<t;r++){e.push(s());n.nextFrame()}return Base32.decode(e)};this.download=function(){var e=new Blob([n.getRaw()],{type:"octet-stream"});triggerDownload(r,e)}}var CryptoJS=CryptoJS||function(s,r){var e={},t=e.lib={},n=function(){},i=t.Base={extend:function(e){n.prototype=this;var t=new n;e&&t.mixIn(e);t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)});t.init.prototype=t;t.$super=this;return t},create:function(){var e=this.extend();e.init.apply(e,arguments);return e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=t.WordArray=i.extend({init:function(e,t){e=this.words=e||[];this.sigBytes=t!=r?t:4*e.length},toString:function(e){return(e||o).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes;e=e.sigBytes;this.clamp();if(n%4)for(var i=0;i<e;i++)t[n+i>>>2]|=(r[i>>>2]>>>24-8*(i%4)&255)<<24-8*((n+i)%4);else if(65535<r.length)for(i=0;i<e;i+=4)t[n+i>>>2]=r[i>>>2];else t.push.apply(t,r);this.sigBytes+=e;return this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-8*(t%4);e.length=s.ceil(t/4)},clone:function(){var e=i.clone.call(this);e.words=this.words.slice(0);return e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(4294967296*s.random()|0);return new c.init(t,e)}}),a=e.enc={},o=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],n=0;n<e;n++){var i=t[n>>>2]>>>24-8*(n%4)&255;r.push((i>>>4).toString(16));r.push((i&15).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-4*(n%8);return new c.init(r,t/2)}},u=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],n=0;n<e;n++)r.push(String.fromCharCode(t[n>>>2]>>>24-8*(n%4)&255));return r.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(e.charCodeAt(n)&255)<<24-8*(n%4);return new c.init(r,t)}},f=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=t.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new c.init;this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e));this._data.concat(e);this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,r=t.words,n=t.sigBytes,i=this.blockSize,a=n/(4*i),a=e?s.ceil(a):s.max((a|0)-this._minBufferSize,0);e=a*i;n=s.min(4*e,n);if(e){for(var o=0;o<e;o+=i)this._doProcessBlock(r,o);o=r.splice(0,e);t.sigBytes-=n}return new c.init(o,n)},clone:function(){var e=i.clone.call(this);e._data=this._data.clone();return e},_minBufferSize:0});t.Hasher=d.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e);this.reset()},reset:function(){d.reset.call(this);this._doReset()},update:function(e){this._append(e);this._process();return this},finalize:function(e){e&&this._append(e);return this._doFinalize()},blockSize:16,_createHelper:function(r){return function(e,t){return new r.init(t).finalize(e)}},_createHmacHelper:function(r){return function(e,t){return new h.HMAC.init(r,t).finalize(e)}}});var h=e.algo={};return e}(Math);(function(){var e=CryptoJS,c=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();e=[];for(var i=0;i<r;i+=3)for(var a=(t[i>>>2]>>>24-8*(i%4)&255)<<16|(t[i+1>>>2]>>>24-8*((i+1)%4)&255)<<8|t[i+2>>>2]>>>24-8*((i+2)%4)&255,o=0;4>o&&i+.75*o<r;o++)e.push(n.charAt(a>>>6*(3-o)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,r=this._map,n=r.charAt(64);n&&(n=e.indexOf(n),-1!=n&&(t=n));for(var n=[],i=0,a=0;a<t;a++)if(a%4){var o=r.indexOf(e.charAt(a-1))<<2*(a%4),s=r.indexOf(e.charAt(a))>>>6-2*(a%4);n[i>>>2]|=(o|s)<<24-8*(i%4);i++}return c.create(n,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(a){function B(e,t,r,n,i,a,o){e=e+(t&r|~t&n)+i+o;return(e<<a|e>>>32-a)+t}function w(e,t,r,n,i,a,o){e=e+(t&n|r&~n)+i+o;return(e<<a|e>>>32-a)+t}function k(e,t,r,n,i,a,o){e=e+(t^r^n)+i+o;return(e<<a|e>>>32-a)+t}function b(e,t,r,n,i,a,o){e=e+(r^(t|~n))+i+o;return(e<<a|e>>>32-a)+t}for(var e=CryptoJS,t=e.lib,r=t.WordArray,n=t.Hasher,t=e.algo,z=[],i=0;64>i;i++)z[i]=4294967296*a.abs(a.sin(i+1))|0;t=t.MD5=n.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;16>r;r++){var n=t+r,i=e[n];e[n]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360}var r=this._hash.words,n=e[t+0],i=e[t+1],a=e[t+2],o=e[t+3],s=e[t+4],c=e[t+5],u=e[t+6],f=e[t+7],d=e[t+8],h=e[t+9],l=e[t+10],p=e[t+11],v=e[t+12],y=e[t+13],g=e[t+14],m=e[t+15],_=r[0],x=r[1],S=r[2],C=r[3],_=B(_,x,S,C,n,7,z[0]),C=B(C,_,x,S,i,12,z[1]),S=B(S,C,_,x,a,17,z[2]),x=B(x,S,C,_,o,22,z[3]),_=B(_,x,S,C,s,7,z[4]),C=B(C,_,x,S,c,12,z[5]),S=B(S,C,_,x,u,17,z[6]),x=B(x,S,C,_,f,22,z[7]),_=B(_,x,S,C,d,7,z[8]),C=B(C,_,x,S,h,12,z[9]),S=B(S,C,_,x,l,17,z[10]),x=B(x,S,C,_,p,22,z[11]),_=B(_,x,S,C,v,7,z[12]),C=B(C,_,x,S,y,12,z[13]),S=B(S,C,_,x,g,17,z[14]),x=B(x,S,C,_,m,22,z[15]),_=w(_,x,S,C,i,5,z[16]),C=w(C,_,x,S,u,9,z[17]),S=w(S,C,_,x,p,14,z[18]),x=w(x,S,C,_,n,20,z[19]),_=w(_,x,S,C,c,5,z[20]),C=w(C,_,x,S,l,9,z[21]),S=w(S,C,_,x,m,14,z[22]),x=w(x,S,C,_,s,20,z[23]),_=w(_,x,S,C,h,5,z[24]),C=w(C,_,x,S,g,9,z[25]),S=w(S,C,_,x,o,14,z[26]),x=w(x,S,C,_,d,20,z[27]),_=w(_,x,S,C,y,5,z[28]),C=w(C,_,x,S,a,9,z[29]),S=w(S,C,_,x,f,14,z[30]),x=w(x,S,C,_,v,20,z[31]),_=k(_,x,S,C,c,4,z[32]),C=k(C,_,x,S,d,11,z[33]),S=k(S,C,_,x,p,16,z[34]),x=k(x,S,C,_,g,23,z[35]),_=k(_,x,S,C,i,4,z[36]),C=k(C,_,x,S,s,11,z[37]),S=k(S,C,_,x,f,16,z[38]),x=k(x,S,C,_,l,23,z[39]),_=k(_,x,S,C,y,4,z[40]),C=k(C,_,x,S,n,11,z[41]),S=k(S,C,_,x,o,16,z[42]),x=k(x,S,C,_,u,23,z[43]),_=k(_,x,S,C,h,4,z[44]),C=k(C,_,x,S,v,11,z[45]),S=k(S,C,_,x,m,16,z[46]),x=k(x,S,C,_,a,23,z[47]),_=b(_,x,S,C,n,6,z[48]),C=b(C,_,x,S,f,10,z[49]),S=b(S,C,_,x,g,15,z[50]),x=b(x,S,C,_,c,21,z[51]),_=b(_,x,S,C,v,6,z[52]),C=b(C,_,x,S,o,10,z[53]),S=b(S,C,_,x,l,15,z[54]),x=b(x,S,C,_,i,21,z[55]),_=b(_,x,S,C,d,6,z[56]),C=b(C,_,x,S,m,10,z[57]),S=b(S,C,_,x,u,15,z[58]),x=b(x,S,C,_,y,21,z[59]),_=b(_,x,S,C,s,6,z[60]),C=b(C,_,x,S,p,10,z[61]),S=b(S,C,_,x,a,15,z[62]),x=b(x,S,C,_,h,21,z[63]);r[0]=r[0]+_|0;r[1]=r[1]+x|0;r[2]=r[2]+S|0;r[3]=r[3]+C|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32;var i=a.floor(r/4294967296);t[(n+64>>>9<<4)+15]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360;t[(n+64>>>9<<4)+14]=(r<<8|r>>>24)&16711935|(r<<24|r>>>8)&4278255360;e.sigBytes=4*(t.length+1);this._process();e=this._hash;t=e.words;for(r=0;4>r;r++)n=t[r],t[r]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360;return e},clone:function(){var e=n.clone.call(this);e._hash=this._hash.clone();return e}});e.MD5=n._createHelper(t);e.HmacMD5=n._createHmacHelper(t)})(Math);(function(){var e=CryptoJS,t=e.lib,r=t.Base,u=t.WordArray,t=e.algo,n=t.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,n=r.hasher.create(),i=u.create(),a=i.words,o=r.keySize,r=r.iterations;a.length<o;){s&&n.update(s);var s=n.update(e).finalize(t);n.reset();for(var c=1;c<r;c++)s=n.finalize(s),n.reset();i.concat(s)}i.sigBytes=4*o;return i}});e.EvpKDF=function(e,t,r){return n.create(r).compute(e,t)}})();CryptoJS.lib.Cipher||function(a){var e=CryptoJS,t=e.lib,r=t.Base,o=t.WordArray,n=t.BufferedBlockAlgorithm,i=e.enc.Base64,s=e.algo.EvpKDF,c=t.Cipher=n.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r);this._xformMode=e;this._key=t;this.reset()},reset:function(){n.reset.call(this);this._doReset()},process:function(e){this._append(e);return this._process()},finalize:function(e){e&&this._append(e);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(n){return{encrypt:function(e,t,r){return("string"==typeof t?p:l).encrypt(n,e,t,r)},decrypt:function(e,t,r){return("string"==typeof t?p:l).decrypt(n,e,t,r)}}}});t.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=e.mode={},f=function(e,t,r){var n=this._iv;n?this._iv=a:n=this._prevBlock;for(var i=0;i<r;i++)e[t+i]^=n[i]},d=(t.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e;this._iv=t}})).extend();d.Encryptor=d.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize;f.call(this,e,t,n);r.encryptBlock(e,t);this._prevBlock=e.slice(t,t+n)}});d.Decryptor=d.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,i=e.slice(t,t+n);r.decryptBlock(e,t);f.call(this,e,t,n);this._prevBlock=i}});u=u.CBC=d;d=(e.pad={}).Pkcs7={pad:function(e,t){for(var r=4*t,r=r-e.sigBytes%r,n=r<<24|r<<16|r<<8|r,i=[],a=0;a<r;a+=4)i.push(n);r=o.create(i,r);e.concat(r)},unpad:function(e){e.sigBytes-=e.words[e.sigBytes-1>>>2]&255}};t.BlockCipher=c.extend({cfg:c.cfg.extend({mode:u,padding:d}),reset:function(){c.reset.call(this);var e=this.cfg,t=e.iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=e.createEncryptor;else r=e.createDecryptor,this._minBufferSize=1;this._mode=r.call(e,this,t&&t.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var h=t.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),u=(e.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;e=e.salt;return(e?o.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){e=i.parse(e);var t=e.words;if(1398893684==t[0]&&1701076831==t[1]){var r=o.create(t.slice(2,4));t.splice(0,4);e.sigBytes-=16}return h.create({ciphertext:e,salt:r})}},l=t.SerializableCipher=r.extend({cfg:r.extend({format:u}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var i=e.createEncryptor(r,n);t=i.finalize(t);i=i.cfg;return h.create({ciphertext:t,key:r,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){n=this.cfg.extend(n);t=this._parse(t,n.format);return e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),e=(e.kdf={}).OpenSSL={execute:function(e,t,r,n){n||(n=o.random(8));e=s.create({keySize:t+r}).compute(e,n);r=o.create(e.words.slice(t),4*r);e.sigBytes=4*t;return h.create({key:e,iv:r,salt:n})}},p=t.PasswordBasedCipher=l.extend({cfg:l.cfg.extend({kdf:e}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);r=n.kdf.execute(r,e.keySize,e.ivSize);n.iv=r.iv;e=l.encrypt.call(this,e,t,r.key,n);e.mixIn(r);return e},decrypt:function(e,t,r,n){n=this.cfg.extend(n);t=this._parse(t,n.format);r=n.kdf.execute(r,e.keySize,e.ivSize,t.salt);n.iv=r.iv;return l.decrypt.call(this,e,t,r.key,n)}})}();(function(){for(var e=CryptoJS,t=e.lib.BlockCipher,r=e.algo,o=[],n=[],i=[],a=[],s=[],c=[],u=[],f=[],d=[],h=[],l=[],p=0;256>p;p++)l[p]=128>p?p<<1:p<<1^283;for(var v=0,y=0,p=0;256>p;p++){var g=y^y<<1^y<<2^y<<3^y<<4,g=g>>>8^g&255^99;o[v]=g;n[g]=v;var m=l[v],_=l[m],x=l[_],S=257*l[g]^16843008*g;i[v]=S<<24|S>>>8;a[v]=S<<16|S>>>16;s[v]=S<<8|S>>>24;c[v]=S;S=16843009*x^65537*_^257*m^16843008*v;u[g]=S<<24|S>>>8;f[g]=S<<16|S>>>16;d[g]=S<<8|S>>>24;h[g]=S;v?(v=m^l[l[l[x^m]]],y^=l[l[y]]):v=y=1}var C=[0,1,2,4,8,16,32,64,128,27,54],r=r.AES=t.extend({_doReset:function(){for(var e=this._key,t=e.words,r=e.sigBytes/4,e=4*((this._nRounds=r+6)+1),n=this._keySchedule=[],i=0;i<e;i++)if(i<r)n[i]=t[i];else{var a=n[i-1];i%r?6<r&&4==i%r&&(a=o[a>>>24]<<24|o[a>>>16&255]<<16|o[a>>>8&255]<<8|o[a&255]):(a=a<<8|a>>>24,a=o[a>>>24]<<24|o[a>>>16&255]<<16|o[a>>>8&255]<<8|o[a&255],a^=C[i/r|0]<<24);n[i]=n[i-r]^a}t=this._invKeySchedule=[];for(r=0;r<e;r++)i=e-r,a=r%4?n[i]:n[i-4],t[r]=4>r||4>=i?a:u[o[a>>>24]]^f[o[a>>>16&255]]^d[o[a>>>8&255]]^h[o[a&255]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,a,s,c,o)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3];e[t+3]=r;this._doCryptBlock(e,t,this._invKeySchedule,u,f,d,h,n);r=e[t+1];e[t+1]=e[t+3];e[t+3]=r},_doCryptBlock:function(e,t,r,n,i,a,o,s){for(var c=this._nRounds,u=e[t]^r[0],f=e[t+1]^r[1],d=e[t+2]^r[2],h=e[t+3]^r[3],l=4,p=1;p<c;p++)var v=n[u>>>24]^i[f>>>16&255]^a[d>>>8&255]^o[h&255]^r[l++],y=n[f>>>24]^i[d>>>16&255]^a[h>>>8&255]^o[u&255]^r[l++],g=n[d>>>24]^i[h>>>16&255]^a[u>>>8&255]^o[f&255]^r[l++],h=n[h>>>24]^i[u>>>16&255]^a[f>>>8&255]^o[d&255]^r[l++],u=v,f=y,d=g;v=(s[u>>>24]<<24|s[f>>>16&255]<<16|s[d>>>8&255]<<8|s[h&255])^r[l++];y=(s[f>>>24]<<24|s[d>>>16&255]<<16|s[h>>>8&255]<<8|s[u&255])^r[l++];g=(s[d>>>24]<<24|s[h>>>16&255]<<16|s[u>>>8&255]<<8|s[f&255])^r[l++];h=(s[h>>>24]<<24|s[u>>>16&255]<<16|s[f>>>8&255]<<8|s[d&255])^r[l++];e[t]=v;e[t+1]=y;e[t+2]=g;e[t+3]=h},keySize:8});e.AES=t._createHelper(r)})();var r,e;CryptoJS.mode.CTR=(r=CryptoJS.lib.BlockCipherMode.extend(),e=r.Encryptor=r.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,i=this._iv,a=this._counter;i&&(a=this._counter=i.slice(0),this._iv=void 0);var o=a.slice(0);r.encryptBlock(o,0),a[n-1]=a[n-1]+1|0;for(var s=0;s<n;s++)e[t+s]^=o[s]}}),r.Decryptor=e,r);CryptoJS.pad.NoPadding={pad:function(){},unpad:function(){}};
